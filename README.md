# ChatOps Telegram Bot

**–í–µ—Ä—Å–∏—è 0.1.0**

**Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è GitHub Issues –∏ CI/CD –∏–∑ —á–∞—Ç–∞ –ø–æ –º–æ–¥–µ–ª–∏ ChatOps**

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

ChatOps Telegram Bot ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –±–æ—Ç –Ω–∞ Python, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ü–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö Issue –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è GitHub  
- –î–æ–±–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ Issue  
- –ó–∞–ø—É—Å–∫–∞—Ç—å —Å–±–æ—Ä–∫–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∏–∑ CI (GitHub Actions)  
- –£–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ–µ–∫—Ç–æ–º, –Ω–µ –≤—ã—Ö–æ–¥—è –∏–∑ Telegram  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ JWT  

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ commands.py
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ github_api.py
‚îÇ       ‚îî‚îÄ‚îÄ ci_api.py
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ config.example.yaml
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ test_github_client.py
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è

### 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python ‚â•3.11  
- Docker & docker-compose  
- –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
  - Telegram Bot Token  
  - GitHub Personal Access Token  
  - JWT Secret  
  - `SETTINGS.github_repo` (—Ñ–æ—Ä–º–∞—Ç `username/repo`)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞:
   ```bash
   cp config/config.example.yaml config/config.yaml
   ```
2. –û—Ç–∫—Ä–æ–π—Ç–µ `config/config.yaml` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è:
   ```yaml
   telegram_token: "–í–ê–®_TELEGRAM_TOKEN"
   github_token:  "–í–ê–®_GITHUB_TOKEN"
   jwt_secret:    "–í–ê–®_JWT_SECRET"
   github_repo:   "username/repo"

   api:
     base_url: "https://api.github.com"
   timeout:
     telegram: 5
     github: 10
   ```

### 3. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker
```bash
docker-compose up --build
```
- –°–µ—Ä–≤–∏—Å `bot` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env`, –µ—Å–ª–∏ –æ–Ω–∏ –∑–∞–¥–∞–Ω—ã  
- Bot –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ long-polling: `skip_updates=True`  

### 4. –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker
1. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ:
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
   ```bash
   python bot/main.py
   ```

### 5. –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ  
- `/help` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥  
- `/issues` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö Issue  
- `/comment <jwt> <–Ω–æ–º–µ—Ä> <—Ç–µ–∫—Å—Ç>` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ Issue  
- `/build <jwt> <workflow_id>` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å workflow  
- `/status <jwt> <workflow_id>` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞  
- `/workflows` ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö workflows  

### 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
pytest --maxfail=1 -q
```

### 7. CI/CD
–§–∞–π–ª: `.github/workflows/ci.yml`  
–®–∞–≥–∏:
- flake8  
- pytest  
- docker build

---

## üîú –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–í —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏** –≤ Telegram: –∑–∞–≥—Ä—É–∑–∫–∞, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞.  
2. **Webhook + HTTPS**: –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤–µ–±—Ö—É–∫–∏ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫ –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏, —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–ª—É—á–µ–Ω–∏–µ–º SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.  
3. **–ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞ Grafana –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞.  

---

*–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ChatOps Telegram Bot!*